<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usar la capacidad de alojamiento</title><meta name="Language" content="es-es" /><meta name="System.Keywords" content="capacidad de alojamiento de transacción" /><meta name="Microsoft.Help.Id" content="aa48306c-e7a0-4dcb-af21-9ebb6898e45a" /><meta name="Description" content="De forma predeterminada, un conjunto de resultados creado dentro de una transacción se mantiene abierto cuando se ha confirmado la transacción a la base de datos o se ha revertido." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usar la capacidad de alojamiento</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>De forma predeterminada, un conjunto de resultados creado dentro de una transacción se mantiene abierto cuando se ha confirmado la transacción a la base de datos o se ha revertido. No obstante, en ocasiones es útil que el conjunto de resultados esté cerrado, incluso después de haber confirmado la transacción. Para ello, el Controlador Microsoft JDBC para SQL Server admite el uso de la capacidad de alojamiento de conjuntos de resultados. </p><p>La capacidad de alojamiento de los conjuntos de resultados se puede configurar con el método <a href="552eebd0-4c38-43f0-961f-35244f99109b.htm">setHoldability</a> de la clase <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. A la hora de configurar la capacidad de alojamiento con el método <b>setHoldability</b>, se pueden usar las constantes de la capacidad de alojamiento del conjunto de resultados de <b>ResultSet.HOLD_CURSORS_OVER_COMMIT</b> o <b>ResultSet.CLOSE_CURSORS_AT_COMMIT</b>.</p><p>El controlador JDBC también es compatible con la configuración de la capacidad de alojamiento cuando se crea uno de los objetos Statement. Al crear los objetos Statement que tengan sobrecargas con los parámetros de la capacidad de alojamiento de los conjuntos de resultados, la capacidad de alojamiento del objeto de instrucción debe coincidir con la capacidad de alojamiento de la sobrecarga. Cuando no coinciden, se genera una excepción. Esto se debe a que SQL Server solamente admite la capacidad de alojamiento en el nivel local.</p><p>La capacidad de alojamiento de un conjunto de resultados es la capacidad de alojamiento del objeto <b>SQLServerConnection</b> asociado con el conjunto de resultados en el momento en el que se creó solamente para los cursores del lado del servidor. Esto no se aplica a los cursores del lado cliente. Todos los conjuntos de resultados del lado cliente tendrán siempre el valor de capacidad de alojamiento de <b>ResultSet.HOLD_CURSORS_OVER_COMMIT</b>.</p><p>Para los cursores de servidor, cuando están conectados a SQL Server 2005 o versiones posteriores, la configuración de la capacidad de alojamiento solamente afecta a la de los nuevos conjuntos de resultados que todavía han de ser creados en esa conexión. Eso significa que la configuración de la capacidad de alojamiento no tiene impacto alguno sobre la capacidad de alojamiento de los conjuntos de resultados creados previamente que ya estaban abiertos en esa conexión. Con SQL Server 2000, sin embargo, configurar la capacidad de alojamiento afecta a la capacidad de alojamiento de los resultados existentes como a la de los nuevos conjuntos de resultados que todavía han de ser creados en esa conexión.</p><p>En el siguiente ejemplo, se configura la capacidad de alojamiento del conjunto de resultados mientras se realiza una transición local, consistente en dos instrucciones independientes en el bloque <span class="code">try</span>. Las instrucciones que se ejecutan contra la tabla Production.ScrapReason de la base de datos de ejemplo AdventureWorks de SQL Server 2005. Primero, el ejemplo cambia al modo de transacción manual configurando la confirmación automática en <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>. Cuando el modo de confirmación automática esté deshabilitado, no se confirmarán instrucciones SQL hasta que la aplicación llame explícitamente al método <a href="c7346165-51bf-4844-b64c-29833c147236.htm">commit</a>. El código del bloque catch revierte la transacción si se genera una excepción.</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>public static void executeTransaction(Connection con) {
   try {
       con.setAutoCommit(false);
       con.setHoldability(ResultSet.HOLD_CURSORS_OVER_COMMIT);
       Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
       stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Bad part')");
       ResultSet rs = stmt.executeQuery("SELECT * FROM Production.ScrapReason");
       con.commit();
       System.out.println("Transaction succeeded.");

       //Display results.
       while (rs.next()) {
          System.out.println(rs.getString(2));
       }
       stmt.close();
      }
      catch (SQLException ex) {
         ex.printStackTrace();
         try {
            System.out.println("Transaction failed.");
            con.rollback();
         }
         catch (SQLException se) {
            se.printStackTrace();
         }
      }
   }
}

</pre></span></div></div></div><span id="seeAlsoSpan"><h1 class="heading">Vea también</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="afbb776f-05dc-4e79-bb25-2c340483e401.htm">Realizar transacciones con el controlador JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Enviar <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dLe%20agradecemos%20sus%20comentarios.%20Los%20equipos%20de%20desarrolladores%20usan%20estos%20comentarios%20para%20mejorar%20la%20documentación.%20Mientras%20revisamos%20los%20comentarios,%20es%20posible%20que%20le%20enviemos%20un%20correo%20electrónico%20para%20solicitarle%20alguna%20aclaración%20o%20comentarios%20sobre%20una%20posible%20solución.%20No%20usamos%20su%20dirección%20de%20correo%20electrónico%20para%20ningún%20otro%20propósito%20y%20ésta%20se%20borra%20una%20vez%20finalizada%20la%20revisió.%0\APara%20obtener%20más%20información%20acerca%20de%20las%20directivas%20de%20privacidad%20de%20Microsoft,%20vea%20http://privacy.microsoft.com/es-es/default.aspx.%0\A%0\d','Comentarios%20del cliente');">comentarios de </a> acerca de este tema Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos los derechos reservados.</a></p></span></div></div></body></html>