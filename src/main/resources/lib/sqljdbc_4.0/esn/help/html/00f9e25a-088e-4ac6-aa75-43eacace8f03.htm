<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usar secuencias de escape SQL</title><meta name="Language" content="es-es" /><meta name="System.Keywords" content="secuencias de escape SQL" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="El Controlador Microsoft JDBC para SQL Server admite el uso de secuencias de escape SQL, según se define en la API de JDBC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usar secuencias de escape SQL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>El Controlador Microsoft JDBC para SQL Server admite el uso de secuencias de escape SQL, según se define en la API de JDBC. Las secuencias de escape se usan dentro de una instrucción SQL para indicar al controlador que la parte de la secuencia de escape de la cadena SQL se debería tratar de forma diferente. Cuando el controlador JDBC procesa la parte de la secuencia de escape de una cadena SQL, traduce esa parte de la cadena en código SQL que SQL Server entiende. </p><p>Hay cinco tipos de secuencias de escape que la API JDBC requiere, y el controlador JDBC las admite todas:</p><ul><li><p>Literales comodín LIKE</p></li><li><p>Tratamiento de funciones</p></li><li><p>Literales de fecha y hora</p></li><li><p>Llamadas a procedimientos almacenados</p></li><li><p>Combinaciones externas</p></li></ul><p>La sintaxis de las secuencias de escape que usa el controlador JDBC es la siguiente:</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>El proceso de escape SQL siempre está activado para el controlador JDBC.</p></div><p>En las secciones siguientes se describen los cinco tipos de secuencias de escape y cómo las admite el controlador JDBC.</p></div><h1 class="heading">Literales comodín LIKE</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>El controlador admite la sintaxis de <span class="code">{escape 'escape character'}</span> para usar comodines de cláusulas LIKE como literales. Por ejemplo, el código siguiente devolverá valores para col3, donde el valor de col2 comienza literalmente con un guión (y no con su uso como comodín).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>La secuencia de escape debe estar al final de la instrucción SQL. Para que haya varias instrucciones SQL en una cadena de comandos, la secuencia de escape tiene que estar al final de cada instrucción SQL pertinente.</p></div></div><h1 class="heading">Tratamiento de funciones</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>El controlador JDBC admite las secuencias de escape de funciones en instrucciones SQL con la sintaxis siguiente:</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>donde <span class="code">functionName</span> es una función que admite el controlador JDBC. Por ejemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>En la tabla siguiente se muestran las diversas funciones que el controlador JDBC admite al usar un flujo de escape de funciones.</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Funciones de cadena</p></th><th><p>Funciones numéricas</p></th><th><p>Funciones de fecha y hora</p></th><th><p>Funciones del sistema</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Si intenta utilizar una función que la base de datos no admita, se producirá un error.</p></div></div><h1 class="heading">Literales de fecha y hora</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>La sintaxis de las secuencias de escape para los literales de fecha, hora y marca de tiempo es la siguiente: </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>donde <span class="code">literal-type</span> es uno de los siguientes:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Tipo de literal</p></th><th><p>Descripción</p></th><th><p>Formato del valor</p></th></tr><tr><td><p>d</p></td><td><p>Fecha</p></td><td><p>aaaa-mm-dd</p></td></tr><tr><td><p>t</p></td><td><p>Hora</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>TimeStamp</p></td><td><p>aaaa-mm-dd hh:mm:ss[.f...]</p></td></tr></table></div><p>Por ejemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Llamadas a procedimientos almacenados</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>El controlador JDBC es compatible con la sintaxis de escape <span class="code">{? = call proc_name(?,...)}</span> y <span class="code">{call proc_name(?,...)}</span> para las llamadas a procedimientos almacenados, según si tiene que procesar un parámetro de devolución. </p><p>Un procedimiento almacenado es un objeto ejecutable almacenado en la base de datos. Normalmente, se trata de una o varias instrucciones SQL compiladas. La sintaxis de las secuencias de escape para llamar a un procedimiento almacenado es la siguiente: </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>donde <span class="code">procedure-name</span> y <span class="code">parameter</span> especifican el nombre y un parámetro de un procedimiento almacenado, respectivamente.</p><p>Para obtener más información acerca de cómo usar la secuencia de escape <span class="code">call</span> con los procedimientos almacenados, vea <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Usar instrucciones con procedimientos almacenados</a></span>.</p></div><h1 class="heading">Combinaciones externas</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>El controlador JDBC admite la sintaxis de combinación externa completa, derecha e izquierda de SQL92. La secuencia de escape para las combinaciones externas es:</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>donde outer-join es:</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>donde <span class="code">table-reference</span> es un nombre de tabla y <span class="code">search-condition</span> es la condición de combinación que desea usar para las tablas.</p><p>Por ejemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>El controlador JDBC admite las siguientes secuencias de escape de combinaciones externas:</p><ul><li><p>Combinaciones externas izquierdas</p></li><li><p>Combinaciones externas derechas</p></li><li><p>Combinaciones externas completas</p></li><li><p>Combinaciones externas anidadas</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">Vea también</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Usar instrucciones con el controlador JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Enviar <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dLe%20agradecemos%20sus%20comentarios.%20Los%20equipos%20de%20desarrolladores%20usan%20estos%20comentarios%20para%20mejorar%20la%20documentación.%20Mientras%20revisamos%20los%20comentarios,%20es%20posible%20que%20le%20enviemos%20un%20correo%20electrónico%20para%20solicitarle%20alguna%20aclaración%20o%20comentarios%20sobre%20una%20posible%20solución.%20No%20usamos%20su%20dirección%20de%20correo%20electrónico%20para%20ningún%20otro%20propósito%20y%20ésta%20se%20borra%20una%20vez%20finalizada%20la%20revisió.%0\APara%20obtener%20más%20información%20acerca%20de%20las%20directivas%20de%20privacidad%20de%20Microsoft,%20vea%20http://privacy.microsoft.com/es-es/default.aspx.%0\A%0\d','Comentarios%20del cliente');">comentarios de </a> acerca de este tema Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos los derechos reservados.</a></p></span></div></div></body></html>