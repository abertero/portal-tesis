<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usar múltiples conjuntos de resultados</title><meta name="Language" content="es-es" /><meta name="System.Keywords" content="múltiples conjuntos de resultados" /><meta name="Microsoft.Help.Id" content="ab6a3cfa-073b-44e9-afca-a8675cfe5fd1" /><meta name="Description" content="Cuando se trabaja con procedimientos incluidos o almacenados de SQL o de SQL Server que devuelven más de un conjunto de resultados, el Controlador Microsoft JDBC para SQL Server proporciona el método getResultSet en la clase SQLServerStatement para recuper" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usar múltiples conjuntos de resultados</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Cuando se trabaja con procedimientos incluidos o almacenados de SQL o de SQL Server que devuelven más de un conjunto de resultados, el Controlador Microsoft JDBC para SQL Server proporciona el método <a href="929a14e2-8e98-4c32-89aa-86733c717ec1.htm">getResultSet</a> en la clase <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> para recuperar todos los conjuntos de resultados devueltos. Además, si ejecuta una instrucción que devuelva más de un conjunto de resultados, puede usar el método <a href="e1367f39-23d7-4e26-b160-6d988d7e6988.htm">execute</a> de la clase <b>SQLServerStatement</b>, porque devolverá un valor <span sdata="langKeyword" value="boolean"><span class="keyword">boolean</span></span> que indica que el valor devuelto es un conjunto de resultados o un recuento de actualización. </p><p>Si el método <b>execute</b> devuelve <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, la instrucción que se ha ejecutado ha devuelto uno o más conjuntos de resultados. Puede tener acceso al primer conjunto de resultados llamando al método <b>getResultSet</b>. Para determinar si hay más conjuntos de resultados disponibles, puede llamar al método <a href="6b18510a-4d6d-4eeb-a9d0-32e920eb0048.htm">getMoreResults</a>, que devuelve el valor <span sdata="langKeyword" value="boolean"><span class="keyword">boolean</span></span><span sdata="langKeyword" value="true"><span class="keyword">true</span></span> si hay disponibles más conjuntos de resultados. Si hay disponibles más conjuntos de resultados, puede volver a llamar al método <b>getResultSet</b> para tener acceso a ellos, continuando el proceso hasta haber procesado todos los conjuntos de resultados. Si el método <b>getMoreResults</b> devuelve <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, no hay más conjuntos de resultados que procesar.</p><p>Si el método <b>execute</b> devuelve <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, la instrucción que se ha ejecutado ha devuelto un valor de recuento de actualización, que puede recuperar llamando al método <a href="e9570228-4500-44b6-b2f1-84ac050b5112.htm">getUpdateCount</a>.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Para obtener más información sobre recuentos de actualizaciones, vea <span sdata="link"><a href="64cf4877-5995-4bfc-8865-b7618a5c8d01.htm">Usar un procedimiento almacenado con un recuento de actualizaciones</a></span>.</p></div><p>En el siguiente ejemplo, se pasa a la función una conexión abierta a la base de datos de ejemplo SQL Server 2005 AdventureWorks y se construye una instrucción SQL que, cuando se ejecuta, devuelve dos conjuntos de resultados:</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>public static void executeStatement(Connection con) {
   try {
      String SQL = "SELECT TOP 10 * FROM Person.Contact; " +
                   "SELECT TOP 20 * FROM Person.Contact";
      Statement stmt = con.createStatement();
      boolean results = stmt.execute(SQL);
      int rsCount = 0;

      //Loop through the available result sets.
     do {
        if(results) {
           ResultSet rs = stmt.getResultSet();
           rsCount++;

           //Show data from the result set.
           System.out.println("RESULT SET #" + rsCount);
           while (rs.next()) {
              System.out.println(rs.getString("LastName") + ", " + rs.getString("FirstName"));
           }
           rs.close();
        }
        System.out.println();
        results = stmt.getMoreResults();
        } while(results);
      stmt.close();
      }
   catch (Exception e) {
      e.printStackTrace();
   }
}

</pre></span></div></div><p>En este caso, se sabe que el número de conjuntos de resultados que se devuelven es dos. No obstante, el código está escrito de forma que si se devolviera un número desconocido de conjuntos de resultados, como cuando se llama a un procedimiento almacenado, se procesarían todos. Para ver un ejemplo de llamada a un procedimiento almacenado que devuelve múltiples conjuntos de resultados además de valores de actualización, consulte <span sdata="link"><a href="6b807a45-a8b5-4b1c-8b7b-d8175c710ce0.htm">Controlar instrucciones complejas</a></span>.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Cuando hace la llamada al método <b>getMoreResults</b> de la clase <b>SQLServerStatement</b>, se cierra el conjunto de resultados que se había devuelto anteriormente.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Vea también</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Usar instrucciones con el controlador JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Enviar <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dLe%20agradecemos%20sus%20comentarios.%20Los%20equipos%20de%20desarrolladores%20usan%20estos%20comentarios%20para%20mejorar%20la%20documentación.%20Mientras%20revisamos%20los%20comentarios,%20es%20posible%20que%20le%20enviemos%20un%20correo%20electrónico%20para%20solicitarle%20alguna%20aclaración%20o%20comentarios%20sobre%20una%20posible%20solución.%20No%20usamos%20su%20dirección%20de%20correo%20electrónico%20para%20ningún%20otro%20propósito%20y%20ésta%20se%20borra%20una%20vez%20finalizada%20la%20revisió.%0\APara%20obtener%20más%20información%20acerca%20de%20las%20directivas%20de%20privacidad%20de%20Microsoft,%20vea%20http://privacy.microsoft.com/es-es/default.aspx.%0\A%0\d','Comentarios%20del cliente');">comentarios de </a> acerca de este tema Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos los derechos reservados.</a></p></span></div></div></body></html>