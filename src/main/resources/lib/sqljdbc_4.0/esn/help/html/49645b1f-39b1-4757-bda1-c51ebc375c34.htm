<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Conectar con una base de datos en SQL Azure</title><meta name="Language" content="es-es" /><meta name="System.Keywords" content="SQL Azure" /><meta name="Microsoft.Help.Id" content="49645b1f-39b1-4757-bda1-c51ebc375c34" /><meta name="Description" content="En este tema se describen los problemas al usar Controlador Microsoft JDBC para SQL Server para conectarse a una base de datos de SQL Azure. Para obtener más información acerca de las bases de datos de SQL Azure, vea:" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Conectar con una base de datos en SQL Azure</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>En este tema se describen los problemas al usar Controlador Microsoft JDBC para SQL Server para conectarse a una base de datos de SQL Azure. Para obtener más información acerca de las bases de datos de SQL Azure, vea:</p><ul><li><p><a href="http://go.microsoft.com/fwlink/?LinkID=202490">Base de datos de SQL Azure</a></p></li><li><p><a href="http://msdn.microsoft.com/library/gg715284.aspx">Cómo conectar a SQL Azure mediante JDBC</a></p></li><li><p><a href="http://msdn.microsoft.com/library/windowsazure/hh749029(VS.103).aspx">Usar SQL AZure en Java</a></p></li></ul></div><h1 class="heading">Detalles</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><dl class="authored"><dt>En SQL Azure, debe conectarse a la base de datos maestra para llamar a <span sdata="langKeyword" value="SQLServerDatabaseMetaData.getCatalogs"><span class="keyword">SQLServerDatabaseMetaData.getCatalogs</span></span>.</dt><dd><p>SQL Azure no admite devolver todo el conjunto de catálogos de una base de datos de usuario. <span sdata="langKeyword" value="SQLServerDatabaseMetaData.getCatalogs"><span class="keyword">SQLServerDatabaseMetaData.getCatalogs</span></span> usa la vista sys.databases para obtener los catálogos. Consulte la explicación de los permisos en <a href="http://go.microsoft.com/fwlink/?LinkId=217396">sys.databases (Base de datos de SQL Azure)</a> para entender el comportamiento de <span sdata="langKeyword" value="SQLServerDatabaseMetaData.getCatalogs"><span class="keyword">SQLServerDatabaseMetaData.getCatalogs</span></span> en SQL Azure.</p></dd><dt>Conexiones eliminadas</dt><dd><p>Al conectar con SQL Azure, las conexión inactivas se pueden terminar mediante un componente de red (como un firewall) después de un periodo de inactividad. Para evitar que un componente de red elimine las conexiones inactivada, se debe establecer la siguiente configuración del Registro (o su equivalente si no es Windows) en el sistema operativo donde esté cargado el controlador:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Configuración del Registro</p></th><th><p>Valor recomendado</p></th></tr><tr><td><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\KeepAliveTime</p></td><td><p>30000</p></td></tr><tr><td><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\KeepAliveInterval</p></td><td><p>1000</p></td></tr><tr><td><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\TcpMaxDataRetransmission</p></td><td><p>10</p></td></tr></table></div><p>A continuación, debe reiniciar el equipo para que surta efecto la configuración del Registro.</p><p>Para llevar a cabo esta tarea cuando se ejecuta en Windows Azure, cree una tarea de inicio para agregar las claves del Registro.  Por ejemplo, agregue la siguiente tarea de inicio al archivo de definición de servicios:</p><div class="sampleCode"><span codeLanguage="other"><pre>&lt;Startup&gt;
    &lt;Task commandLine="AddKeepAlive.cmd" executionContext="elevated" taskType="simple"&gt;
    &lt;/Task&gt;
&lt;/Startup&gt;</pre></span></div><p>A continuación, agregue un archivo AddKeepAlive.cmd al proyecto. Establezca la configuración "Copy to Output Directory" en Copy always. A continuación se muestra un archivo AddKeepAlive.cmd de ejemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>if exist keepalive.txt goto done
time /t &gt; keepalive.txt
REM Workaround for JDBC keep alive on SQL Azure
REG ADD HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v KeepAliveTime /t REG_DWORD /d 30000 &gt;&gt; keepalive.txt
REG ADD HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v KeepAliveInterval /t REG_DWORD /d 1000 &gt;&gt; keepalive.txt
REG ADD HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v TcpMaxDataRetransmission /t REG_DWORD /d 10 &gt;&gt; keepalive.txt
shutdown /r /t 1
:done</pre></span></div></dd><dt>Anexar el nombre de servidor al identificador de usuario en la cadena de conexión</dt><dd><p>Antes de la versión 4.0 de Controlador Microsoft JDBC para SQL Server, al conectarse a una base de datos de SQL Azure, se tenía anexar el nombre de servidor al identificador de usuario en la cadena de conexión. Por ejemplo, usuario@nombreDeServidor. A partir de la versión 4.0 de Controlador Microsoft JDBC para SQL Server, ya no es necesario anexar @nombreDeServidor al identificador de usuario en la cadena de conexión.</p></dd><dt>Usar el cifrado requiere establecer hostNameInCertificate</dt><dd><p>Al conectarse con SQL Azure, debe especificar <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span> si especifica <span sdata="langKeyword" value="encrypt=true"><span class="keyword">encrypt=true</span></span>. (Si el nombre de servidor en la cadena de conexión es <span class="parameter" sdata="paramReference">shortName</span>.<span class="parameter" sdata="paramReference">domainName</span>, establezca la propiedad <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span> en *.<span class="parameter" sdata="paramReference">domainName</span>.)</p><p>Por ejemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>jdbc:sqlserver://abcd.int.mscds.com;databaseName= myDatabase;user=myName;password=myPassword;encrypt=true;hostNameInCertificate= *.int.mscds.com;</pre></span></div></dd></dl></div><span id="seeAlsoSpan"><h1 class="heading">Vea también</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">Conectar SQL Server con el controlador JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Enviar <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dLe%20agradecemos%20sus%20comentarios.%20Los%20equipos%20de%20desarrolladores%20usan%20estos%20comentarios%20para%20mejorar%20la%20documentación.%20Mientras%20revisamos%20los%20comentarios,%20es%20posible%20que%20le%20enviemos%20un%20correo%20electrónico%20para%20solicitarle%20alguna%20aclaración%20o%20comentarios%20sobre%20una%20posible%20solución.%20No%20usamos%20su%20dirección%20de%20correo%20electrónico%20para%20ningún%20otro%20propósito%20y%20ésta%20se%20borra%20una%20vez%20finalizada%20la%20revisió.%0\APara%20obtener%20más%20información%20acerca%20de%20las%20directivas%20de%20privacidad%20de%20Microsoft,%20vea%20http://privacy.microsoft.com/es-es/default.aspx.%0\A%0\d','Comentarios%20del cliente');">comentarios de </a> acerca de este tema Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos los derechos reservados.</a></p></span></div></div></body></html>