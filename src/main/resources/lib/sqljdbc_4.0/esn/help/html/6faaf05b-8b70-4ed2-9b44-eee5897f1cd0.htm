<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usar el controlador JDBC</title><meta name="Language" content="es-es" /><meta name="System.Keywords" content="introducción al controlador JDBC, usar el controlador JDBC" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="En esta sección se proporciona una serie de instrucciones rápidas para establecer una conexión sencilla a una base de datos de SQL Server mediante el Controlador Microsoft JDBC para SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usar el controlador JDBC</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>En esta sección se proporciona una serie de instrucciones rápidas para establecer una conexión sencilla a una base de datos de SQL Server mediante el Controlador Microsoft JDBC para SQL Server. Antes de establecer la conexión a una base de datos de SQL Server, SQL Server se debe instalar en el equipo local o en un servidor y el controlador JDBC se debe instalar en el equipo local. </p></div><h1 class="heading">Elegir el archivo JAR adecuado</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>El Controlador Microsoft JDBC para SQL Server proporciona los archivos de biblioteca de clases <span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> y <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span> que se van a usar dependiendo de su configuración preferida de Java Runtime Environment (JRE). Para obtener más información acerca del archivo JAR que hay que elegir, vea <span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">Requisitos del sistema para el controlador JDBC</a></span>.</p></div><h1 class="heading">Establecer la ruta de clase</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>El controlador JDBC no forma parte del SDK de Java. Si lo quiere usar, debe configurar la ruta de clase para que incluya el archivo sqljdbc4.jar. Si en la ruta de clase falta una entrada para sqljdbc.jar o sqljdbc4.jar, su aplicación producirá la excepción común "Clase no encontrada".</p><p>El archivo sqljdbc.jar y el archivo sqljdbc4.jar se instalan en la siguiente ubicación:</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>El siguiente es un ejemplo de la instrucción CLASSPATH usada para una aplicación Windows:</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>El siguiente es un ejemplo de la instrucción CLASSPATH usada para una aplicación de Unix/Linux:</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>Debe asegurarse de que la instrucción CLASSPATH solo contenga un Controlador Microsoft JDBC para SQL Server, como sqljdbc.jar o sqljdbc4.jar.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>En los sistemas de Windows, los nombres de directorio mayores que 8.3 o los nombres de carpetas con espacios pueden causar problemas con las rutas de clase. Si considera que se da este tipo de problema, debe mover temporalmente el archivo sqljdbc.jar o el archivo sqljdbc4.jar a un nombre de directorio sencillo, como<span class="code"> C:\Temp</span>, cambiar la ruta de clase y determinar si de este modo se corrige el problema.</p></div><h1 class="heading">Aplicaciones que se ejecutan directamente en el símbolo del sistema</h1><div class="subsection"><p>La ruta de clase se configura en el sistema operativo. Anexe sqljdbc.jar o sqljdbc4.jar a la ruta de clase del sistema. Además, puede especificar la ruta de clase en la línea de comandos de Java que ejecuta la aplicación con la opción<span class="code"> java -classpath </span>.</p></div><h1 class="heading">Aplicaciones que se ejecutan en un IDE</h1><div class="subsection"><p>Cada proveedor de IDE ofrece un método distinto para establecer la ruta de clase en el IDE. Establecer sin más la ruta de clase en el sistema operativo no funciona. Debe agregar sqljdbc.jar o sqljdbc4.jar a la ruta de clase IDE.</p></div><h1 class="heading">Servlets y JSP</h1><div class="subsection"><p>Los servlets y JSP se ejecutan en un motor de servlet/JSP, como Tomcat. La ruta de clase se debe establecer de acuerdo con la documentación del motor de servlet/JSP. Establecer sin más la ruta de clase en el sistema operativo no funciona. Algunos motores de servlet/JSP incluyen pantallas de configuración que puede utilizar para establecer la ruta de clase del motor. En este caso, debe adjuntar el archivo JAR del controlador JDBC correcto a la ruta de clase del motor y reiniciar el motor. En otras situaciones, puede configurar el controlador copiando sqljdbc.jar o  sqljdbc4.jar en un directorio específico, como lib, durante la instalación del motor. La ruta de clase del controlador del motor también se puede especificar en un archivo de configuración específico del motor.</p></div><h1 class="heading">Enterprise Java Beans</h1><div class="subsection"><p>Enterprise Java Beans (EJB) se ejecuta en un contenedor EJB. Los contenedores EJB son distribuidos por varios proveedores. Los applets Java se ejecutan en un explorador, pero se descargan desde un servidor web. Copie sqljdbc.jar o sqljdbc4.jar en la raíz del servidor web y especifique el nombre del archivo JAR en la pestaña de archivo HTML del applet; por ejemplo, <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span>.</p></div></div><h1 class="heading">Establecer una conexión sencilla con una base de datos</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Mediante la biblioteca de clases sqljdbc.jar, primero las aplicaciones deben registrar el controlador del modo siguiente:</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>Una vez cargado el controlador, puede establecer una conexión con una URL de conexión y el método <b>getConnection</b> de la clase <b>DriverManager</b>:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>En la API 4.0 de JDBC, el método <b>DriverManager.getConnection</b> se ha mejorado para que se carguen los controladores JDBC automáticamente. Por tanto, no es necesario que las aplicaciones llamen al método <b>Class.forName</b> para registrar o cargar el controlador cuando se use la biblioteca de clases sqljdbc4.jar.</p><p>Cuando se llama al método <b>getConnection</b> de la clase <b>DriverManager</b>, se encuentra un controlador apropiado en el conjunto de controladores JDBC. El archivo sqljdbc4.jar incluye el archivo "META-INF/services/java.sql.Driver", que contiene el <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span> como un controlador registrado. Las aplicaciones existentes, que actualmente cargan los controladores usando el método <b>Class.forName</b>, seguirán trabajando sin modificación.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>La biblioteca de clases sqljdbc4.jar necesita la versión 6.0 de Java Runtime Environment (JRE) o una posterior.</p></div><p>Para obtener más información acerca de la conexión con orígenes de datos y el uso de una URL de conexión, vea <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Generar URL de conexión</a></span> y <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Establecer las propiedades de conexión</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Vea también</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">Introducción al controlador JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Enviar <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dLe%20agradecemos%20sus%20comentarios.%20Los%20equipos%20de%20desarrolladores%20usan%20estos%20comentarios%20para%20mejorar%20la%20documentación.%20Mientras%20revisamos%20los%20comentarios,%20es%20posible%20que%20le%20enviemos%20un%20correo%20electrónico%20para%20solicitarle%20alguna%20aclaración%20o%20comentarios%20sobre%20una%20posible%20solución.%20No%20usamos%20su%20dirección%20de%20correo%20electrónico%20para%20ningún%20otro%20propósito%20y%20ésta%20se%20borra%20una%20vez%20finalizada%20la%20revisió.%0\APara%20obtener%20más%20información%20acerca%20de%20las%20directivas%20de%20privacidad%20de%20Microsoft,%20vea%20http://privacy.microsoft.com/es-es/default.aspx.%0\A%0\d','Comentarios%20del cliente');">comentarios de </a> acerca de este tema Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos los derechos reservados.</a></p></span></div></div></body></html>